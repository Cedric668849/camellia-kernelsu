name: Build Camellia KernelSU Kernel

on:
  workflow_dispatch:
    inputs:
      kernelsu_version:
        description: 'KernelSUç‰ˆæœ¬æ ‡ç­¾ï¼ˆç•™ç©ºä½¿ç”¨æœ€æ–°ï¼‰'
        required: false
        default: ''

jobs:
  build:
    runs-on: ubuntu-22.04
    timeout-minutes: 60

    steps:
    - name: æ£€å‡ºä»“åº“
      uses: actions/checkout@v4

    - name: æ¸…ç†ç£ç›˜ç©ºé—´
      run: |
        echo "===== æ¸…ç†å‰ç£ç›˜ä½¿ç”¨ ====="
        df -h

        echo "æ¸…ç†ä¸éœ€è¦çš„è½¯ä»¶..."
        sudo rm -rf /usr/share/dotnet
        sudo rm -rf /opt/ghc
        sudo rm -rf /usr/local/share/boost
        sudo rm -rf "$AGENT_TOOLSDIRECTORY"
        sudo rm -rf /usr/local/lib/android
        sudo rm -rf /opt/hostedtoolcache/CodeQL
        sudo rm -rf /usr/local/graalvm/
        sudo rm -rf /usr/local/share/powershell
        sudo rm -rf /usr/local/share/chromium
        sudo rm -rf /usr/local/lib/node_modules

        echo "æ¸…ç†APTç¼“å­˜..."
        sudo apt-get clean
        sudo apt-get autoremove -y

        echo "===== æ¸…ç†åç£ç›˜ä½¿ç”¨ ====="
        df -h
        echo "å¯ç”¨ç©ºé—´: $(df -h / | awk 'NR==2 {print $4}')"

    - name: å®‰è£…ç¼–è¯‘ä¾èµ–
      run: |
        sudo apt update
        sudo apt install -y \
          bc bison build-essential ccache curl flex \
          git gnupg gperf liblz4-tool \
          libncurses-dev libsdl1.2-dev libssl-dev \
          libxml2 libxml2-utils lzop pngcrush rsync schedtool squashfs-tools \
          xsltproc zip zlib1g-dev python3 python3-pip device-tree-compiler wget \
          gcc-aarch64-linux-gnu g++-aarch64-linux-gnu

        echo "GCCç‰ˆæœ¬:"
        aarch64-linux-gnu-gcc --version

    - name: è®¾ç½®ccache
      uses: hendrikmuhs/ccache-action@v1.2
      with:
        max-size: "2G"

    - name: ä¸‹è½½å†…æ ¸æºç ï¼ˆä½¿ç”¨å‹ç¼©åŒ…ï¼‰
      run: |
        cd $HOME
        echo "å¼€å§‹ä¸‹è½½å†…æ ¸æºç å‹ç¼©åŒ…..."

        # ç›´æ¥ä¸‹è½½ZIPå‹ç¼©åŒ…
        wget -q --show-progress --timeout=300 \
          https://github.com/MiCode/Xiaomi_Kernel_OpenSource/archive/refs/heads/camellia-r-oss.zip \
          -O kernel.zip || {
            echo "GitHubä¸‹è½½å¤±è´¥ï¼Œå°è¯•åŠ é€Ÿé“¾æ¥..."
            wget -q --show-progress --timeout=300 \
              https://ghproxy.com/https://github.com/MiCode/Xiaomi_Kernel_OpenSource/archive/refs/heads/camellia-r-oss.zip \
              -O kernel.zip || {
                echo "å†æ¬¡å°è¯•é•œåƒ..."
                wget -q --show-progress --timeout=300 \
                  https://gh.api.99988866.xyz/https://github.com/MiCode/Xiaomi_Kernel_OpenSource/archive/refs/heads/camellia-r-oss.zip \
                  -O kernel.zip
              }
          }

        echo "è§£å‹å†…æ ¸æºç ..."
        unzip -q kernel.zip
        mv Xiaomi_Kernel_OpenSource-camellia-r-oss kernel
        rm kernel.zip

        echo "å†…æ ¸æºç å‡†å¤‡å®Œæˆ"
        ls -la kernel/

    - name: ä¸‹è½½KernelSU
      run: |
        cd $HOME
        echo "ä¸‹è½½KernelSU..."

        if [ -n "${{ github.event.inputs.kernelsu_version }}" ]; then
          wget -q --show-progress \
            https://github.com/tiann/KernelSU/archive/refs/tags/${{ github.event.inputs.kernelsu_version }}.zip \
            -O kernelsu.zip || \
          wget -q --show-progress \
            https://ghproxy.com/https://github.com/tiann/KernelSU/archive/refs/tags/${{ github.event.inputs.kernelsu_version }}.zip \
            -O kernelsu.zip
        else
          wget -q --show-progress \
            https://github.com/tiann/KernelSU/archive/refs/heads/main.zip \
            -O kernelsu.zip || \
          wget -q --show-progress \
            https://ghproxy.com/https://github.com/tiann/KernelSU/archive/refs/heads/main.zip \
            -O kernelsu.zip
        fi

        unzip -q kernelsu.zip
        mv KernelSU-* KernelSU
        rm kernelsu.zip

        echo "KernelSUå‡†å¤‡å®Œæˆ"
        ls -la KernelSU/kernel/

    - name: é›†æˆKernelSUåˆ°å†…æ ¸
      run: |
        cd $HOME/kernel

        # å¤åˆ¶KernelSUæ¨¡å—åˆ°å†…æ ¸
        cp -r $HOME/KernelSU/kernel drivers/kernelsu

        # éªŒè¯
        if [ -d "drivers/kernelsu" ]; then
          echo "âœ… KernelSUé›†æˆæˆåŠŸ"
          ls -la drivers/kernelsu/
        else
          echo "âŒ KernelSUé›†æˆå¤±è´¥"
          exit 1
        fi

        # ä¿®æ”¹Makefile
        if ! grep -q "kernelsu" drivers/Makefile; then
          echo 'obj-y += kernelsu/' >> drivers/Makefile
          echo "å·²æ·»åŠ KernelSUåˆ°Makefile"
        fi

        # ä¿®æ”¹Kconfig
        if ! grep -q "kernelsu" drivers/Kconfig; then
          echo 'source "drivers/kernelsu/Kconfig"' >> drivers/Kconfig
          echo "å·²æ·»åŠ KernelSUåˆ°Kconfig"
        fi

        echo "KernelSUé›†æˆé…ç½®å®Œæˆ"

    - name: ä¿®å¤å¤´æ–‡ä»¶è·¯å¾„
      run: |
        cd $HOME/kernel

        echo "ä¿®å¤MediaTekå¤´æ–‡ä»¶åŒ…å«è·¯å¾„..."

        # æ–¹æ³•1ï¼šä¿®æ”¹æºæ–‡ä»¶ä½¿ç”¨ç›¸å¯¹è·¯å¾„
        if [ -f "drivers/clk/mediatek/clkdbg-mt6833.c" ]; then
          sed -i 's|#include <clk-mux.h>|#include "./clk-mux.h"|g' drivers/clk/mediatek/clkdbg-mt6833.c
          echo "å·²ä¿®å¤clkdbg-mt6833.c"
        fi

        if [ -f "drivers/cpuidle/cpuidle-mediatek.c" ]; then
          sed -i 's|#include <dt_idle_states.h>|#include "./dt_idle_states.h"|g' drivers/cpuidle/cpuidle-mediatek.c
          echo "å·²ä¿®å¤cpuidle-mediatek.c"
        fi

        # æ–¹æ³•2ï¼šå¤åˆ¶å¤´æ–‡ä»¶åˆ°includeç›®å½•ï¼ˆå¤‡ç”¨ï¼‰
        if [ -f "drivers/clk/mediatek/clk-mux.h" ]; then
          mkdir -p include/linux/clk/mediatek/
          cp drivers/clk/mediatek/*.h include/linux/clk/mediatek/ 2>/dev/null || true
        fi

        echo "å¤´æ–‡ä»¶è·¯å¾„ä¿®å¤å®Œæˆ"

    - name: é…ç½®å†…æ ¸
      run: |
        cd $HOME/kernel

        export ARCH=arm64
        export SUBARCH=arm64
        export CROSS_COMPILE=aarch64-linux-gnu-

        # ä½¿ç”¨camelliaé»˜è®¤é…ç½®
        echo "åº”ç”¨é»˜è®¤é…ç½®..."
        make camellia_defconfig

        # ç¦ç”¨æœ‰ç¼–è¯‘é—®é¢˜çš„é©±åŠ¨ï¼ˆè¿™äº›ä¸æ˜¯å¿…éœ€çš„ï¼‰
        echo "ç¦ç”¨é—®é¢˜é©±åŠ¨..."
        scripts/config --disable CONFIG_COMMON_CLK_MT6833
        scripts/config --disable CONFIG_COMMON_CLK_MT6833_AUDIO
        scripts/config --disable CONFIG_COMMON_CLK_MT6833_CAMSYS
        scripts/config --disable CONFIG_COMMON_CLK_MT6833_IMGSYS
        scripts/config --disable CONFIG_COMMON_CLK_MT6833_IPESYS
        scripts/config --disable CONFIG_COMMON_CLK_MT6833_MDPSYS
        scripts/config --disable CONFIG_COMMON_CLK_MT6833_MFGCFG
        scripts/config --disable CONFIG_COMMON_CLK_MT6833_MMSYS
        scripts/config --disable CONFIG_COMMON_CLK_MT6833_VDECSYS
        scripts/config --disable CONFIG_COMMON_CLK_MT6833_VENCSYS
        scripts/config --disable CONFIG_MTK_IDLE_BALANCE_ENHANCEMENT
        scripts/config --disable CONFIG_MTK_CPUIDLE

        # ç¦ç”¨æ ˆä¿æŠ¤ï¼ˆé¿å…ç¼–è¯‘å™¨å…¼å®¹é—®é¢˜ï¼‰
        echo "ç¦ç”¨æ ˆä¿æŠ¤..."
        scripts/config --disable CONFIG_CC_STACKPROTECTOR_STRONG
        scripts/config --disable CONFIG_CC_STACKPROTECTOR
        scripts/config --disable CONFIG_STACKPROTECTOR
        scripts/config --disable CONFIG_STACKPROTECTOR_STRONG

        # å¯ç”¨KernelSUéœ€è¦çš„é€‰é¡¹
        echo "å¯ç”¨KernelSU..."
        scripts/config --enable CONFIG_KPROBES
        scripts/config --enable CONFIG_HAVE_KPROBES
        scripts/config --enable CONFIG_KPROBE_EVENTS
        scripts/config --enable CONFIG_MODULES
        scripts/config --enable CONFIG_MODULE_UNLOAD

        # æ·»åŠ KernelSUé…ç½®
        echo "CONFIG_KSU=y" >> .config
        echo "CONFIG_KSU_DEBUG=n" >> .config

        # æ›´æ–°é…ç½®
        make olddefconfig

        echo "å†…æ ¸é…ç½®å®Œæˆï¼ŒéªŒè¯å…³é”®é…ç½®:"
        echo "================="
        echo "KernelSUçŠ¶æ€:"
        grep -E "CONFIG_KSU" .config || echo "æœªæ‰¾åˆ°KSUé…ç½®"
        echo "KPROBESçŠ¶æ€:"
        grep -E "CONFIG_KPROBES" .config || echo "æœªæ‰¾åˆ°KPROBESé…ç½®"
        echo "é—®é¢˜é©±åŠ¨çŠ¶æ€:"
        grep -E "CONFIG_COMMON_CLK_MT6833|CONFIG_MTK_CPUIDLE" .config || echo "é—®é¢˜é©±åŠ¨å·²ç¦ç”¨"
        echo "================="

    - name: ç¼–è¯‘å†…æ ¸
      run: |
        cd $HOME/kernel

        export ARCH=arm64
        export SUBARCH=arm64
        export CROSS_COMPILE=aarch64-linux-gnu-
        export CROSS_COMPILE_ARM32=arm-linux-gnueabi-
        export KCFLAGS="-w"
        export CONFIG_CC_STACKPROTECTOR_STRONG=n

        echo "å¼€å§‹ç¼–è¯‘å†…æ ¸ (ä½¿ç”¨ $(nproc) çº¿ç¨‹)..."
        echo "é¢„è®¡éœ€è¦15-20åˆ†é’Ÿ..."
        echo "================="

        # ç¼–è¯‘å†…æ ¸é•œåƒï¼ˆæ˜¾ç¤ºæ›´å¤šè¾“å‡ºä»¥ä¾¿è°ƒè¯•ï¼‰
        make -j$(nproc) Image.gz-dtb 2>&1 | tail -n 200

        # æ£€æŸ¥ç¼–è¯‘ç»“æœ
        if [ -f arch/arm64/boot/Image.gz-dtb ]; then
          echo "================="
          echo "âœ… å†…æ ¸ç¼–è¯‘æˆåŠŸ!"
          ls -lh arch/arm64/boot/Image.gz-dtb
        else
          echo "================="
          echo "âŒ å†…æ ¸ç¼–è¯‘å¤±è´¥"
          echo "å°è¯•æŸ¥æ‰¾å¯èƒ½çš„å†…æ ¸æ–‡ä»¶..."
          find arch/arm64/boot/ -name "Image*" -type f
          exit 1
        fi

    - name: æ‰“åŒ…ç¼–è¯‘äº§ç‰©
      run: |
        mkdir -p $HOME/output

        # å¤åˆ¶å†…æ ¸
        cp $HOME/kernel/arch/arm64/boot/Image.gz-dtb $HOME/output/
        echo "å†…æ ¸æ–‡ä»¶å¤§å°: $(ls -lh $HOME/output/Image.gz-dtb | awk '{print $5}')"

        # ä¸‹è½½boot.imgå¤„ç†å·¥å…·
        cd $HOME/output
        echo "ä¸‹è½½boot.imgå¤„ç†å·¥å…·..."
        wget -q https://github.com/topjohnwu/Magisk/releases/latest/download/Magisk-26.4.apk || \
        wget -q https://ghproxy.com/https://github.com/topjohnwu/Magisk/releases/latest/download/Magisk-26.4.apk

        unzip -q -j Magisk-26.4.apk 'lib/x86_64/libmagiskboot.so'
        mv libmagiskboot.so magiskboot
        chmod +x magiskboot
        rm Magisk-26.4.apk

        # åˆ›å»ºWindowsæ‰¹å¤„ç†è„šæœ¬
        cat > make_boot.bat << 'BAT_END'
        @echo off
        chcp 65001 >nul
        echo =====================================
        echo  KernelSU Boot.img åˆ¶ä½œå·¥å…· (Windows)
        echo =====================================
        echo.
        echo æ³¨æ„ï¼šè¿™æ˜¯KernelSUå†…æ ¸ï¼Œä¸æ˜¯Magiskï¼
        echo.

        if not exist boot.img (
          echo [é”™è¯¯] è¯·å…ˆå°†åŸç‰ˆboot.imgæ”¾åˆ°æœ¬ç›®å½•
          echo.
          echo è·å–boot.imgçš„æ–¹æ³•ï¼š
          echo 1. ä½¿ç”¨ADBå‘½ä»¤ï¼š
          echo    adb shell su -c "dd if=/dev/block/by-name/boot of=/sdcard/boot.img"
          echo    adb pull /sdcard/boot.img
          echo 2. æˆ–ä»å®˜æ–¹ROMåŒ…ä¸­æå–
          echo.
          pause
          exit /b 1
        )

        echo [1/3] è§£åŒ…boot.img...
        magiskboot.exe unpack boot.img
        if errorlevel 1 goto error

        echo [2/3] æ›¿æ¢ä¸ºKernelSUå†…æ ¸...
        copy /Y Image.gz-dtb kernel
        if errorlevel 1 goto error

        echo [3/3] é‡æ–°æ‰“åŒ…...
        magiskboot.exe repack boot.img
        if errorlevel 1 goto error

        echo.
        echo âœ… æˆåŠŸï¼ç”Ÿæˆæ–‡ä»¶: new-boot.img
        echo.
        echo åˆ·å…¥æ­¥éª¤:
        echo 1. adb reboot bootloader
        echo 2. fastboot flash boot new-boot.img
        echo 3. fastboot reboot
        echo.
        echo åˆ·å…¥åè¯·å®‰è£…KernelSUç®¡ç†å™¨
        pause
        exit /b 0

        :error
        echo.
        echo âŒ å‡ºé”™äº†ï¼è¯·æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å®Œæ•´
        pause
        exit /b 1
        BAT_END

        # åˆ›å»ºLinux/Macè„šæœ¬
        cat > make_boot.sh << 'SH_END'
        #!/bin/bash
        echo "====================================="
        echo " KernelSU Boot.img åˆ¶ä½œå·¥å…· (Linux/Mac)"
        echo "====================================="
        echo ""
        echo "æ³¨æ„ï¼šè¿™æ˜¯KernelSUå†…æ ¸ï¼Œä¸æ˜¯Magiskï¼"
        echo ""

        if [ ! -f boot.img ]; then
          echo "[é”™è¯¯] è¯·å…ˆå°†åŸç‰ˆboot.imgæ”¾åˆ°æœ¬ç›®å½•"
          echo ""
          echo "è·å–boot.imgçš„æ–¹æ³•ï¼š"
          echo "1. ä½¿ç”¨ADBå‘½ä»¤ï¼š"
          echo '   adb shell su -c "dd if=/dev/block/by-name/boot of=/sdcard/boot.img"'
          echo "   adb pull /sdcard/boot.img"
          echo "2. æˆ–ä»å®˜æ–¹ROMåŒ…ä¸­æå–"
          echo ""
          exit 1
        fi

        echo "[1/3] è§£åŒ…boot.img..."
        ./magiskboot unpack boot.img || exit 1

        echo "[2/3] æ›¿æ¢ä¸ºKernelSUå†…æ ¸..."
        cp Image.gz-dtb kernel || exit 1

        echo "[3/3] é‡æ–°æ‰“åŒ…..."
        ./magiskboot repack boot.img || exit 1

        echo ""
        echo "âœ… æˆåŠŸï¼ç”Ÿæˆæ–‡ä»¶: new-boot.img"
        echo ""
        echo "åˆ·å…¥æ­¥éª¤:"
        echo "1. adb reboot bootloader"
        echo "2. fastboot flash boot new-boot.img"
        echo "3. fastboot reboot"
        echo ""
        echo "åˆ·å…¥åè¯·å®‰è£…KernelSUç®¡ç†å™¨"
        SH_END
        chmod +x make_boot.sh

        # åˆ›å»ºè¯¦ç»†è¯´æ˜æ–‡æ¡£
        cat > README_CN.txt << 'DOC_END'
        ========================================
          KernelSUå†…æ ¸ for çº¢ç±³Note 10
                  (camellia)
        ========================================

        ã€é‡è¦è¯´æ˜ã€‘
        æœ¬å†…æ ¸é›†æˆäº†KernelSUï¼Œåˆ·å…¥åå°†æ›¿ä»£åŸæœ‰çš„Magisk/Kitsune Mask
        magiskbootåªæ˜¯ç”¨æ¥æ‰“åŒ…boot.imgçš„å·¥å…·ï¼Œä¸åŒ…å«Magisk

        ã€åŒ…å«æ–‡ä»¶ã€‘
        â”œâ”€â”€ Image.gz-dtb    - KernelSUå†…æ ¸æ–‡ä»¶
        â”œâ”€â”€ magiskboot      - Booté•œåƒå¤„ç†å·¥å…·
        â”œâ”€â”€ make_boot.sh    - Linux/Macåˆ¶ä½œè„šæœ¬
        â”œâ”€â”€ make_boot.bat   - Windowsåˆ¶ä½œè„šæœ¬
        â””â”€â”€ README_CN.txt   - æœ¬è¯´æ˜æ–‡ä»¶

        ã€ä½¿ç”¨æ­¥éª¤ã€‘

        æ­¥éª¤1ï¼šå¤‡ä»½åŸç‰ˆboot.img
        -------------------------
        æ–¹æ³•A - ä½¿ç”¨ADBï¼ˆéœ€è¦å½“å‰rootæƒé™ï¼‰ï¼š
          adb shell
          su
          dd if=/dev/block/by-name/boot of=/sdcard/boot_backup.img
          exit
          exit
          adb pull /sdcard/boot_backup.img

        æ–¹æ³•B - ä»å®˜æ–¹ROMæå–ï¼š
          ä¸‹è½½å®˜æ–¹çº¿åˆ·åŒ…ï¼Œè§£å‹åæ‰¾åˆ°boot.img

        æ­¥éª¤2ï¼šåˆ¶ä½œæ–°boot.img
        -------------------------
        1. å°†boot_backup.imgå¤åˆ¶åˆ°æœ¬ç›®å½•å¹¶æ”¹åä¸ºboot.img
        2. è¿è¡Œå¯¹åº”ç³»ç»Ÿçš„è„šæœ¬ï¼š
           - Windows: åŒå‡» make_boot.bat
           - Linux/Mac: ç»ˆç«¯è¿è¡Œ ./make_boot.sh
        3. æˆåŠŸåä¼šç”Ÿæˆnew-boot.img

        æ­¥éª¤3ï¼šåˆ·å…¥æ–°å†…æ ¸
        -------------------------
        1. è¿›å…¥Bootloaderæ¨¡å¼ï¼š
           adb reboot bootloader

        2. åˆ·å…¥å†…æ ¸ï¼š
           fastboot flash boot new-boot.img

        3. é‡å¯ï¼š
           fastboot reboot

        æ­¥éª¤4ï¼šå®‰è£…KernelSUç®¡ç†å™¨
        -------------------------
        ä¸‹è½½åœ°å€ï¼šhttps://github.com/tiann/KernelSU/releases
        å®‰è£…æœ€æ–°ç‰ˆKernelSU.apk

        ã€æ³¨æ„äº‹é¡¹ã€‘
        1. åˆ·å…¥å‰åŠ¡å¿…å¤‡ä»½åŸç‰ˆboot.imgï¼
        2. éœ€è¦å·²è§£é”Bootloader
        3. é¦–æ¬¡åˆ·å…¥å¯èƒ½éœ€è¦æ¸…é™¤æ•°æ®
        4. åŸMagiskæ¨¡å—éœ€è¦è½¬æ¢ä¸ºKernelSUæ¨¡å—
        5. å¦‚æœåˆ·å…¥åæ— æ³•å¼€æœºï¼Œè¿›å…¥fastbootåˆ·å›åŸç‰ˆï¼š
           fastboot flash boot boot_backup.img

        ã€éªŒè¯æ˜¯å¦æˆåŠŸã€‘
        1. å®‰è£…KernelSUç®¡ç†å™¨
        2. æ‰“å¼€åº”è¯¥æ˜¾ç¤º"å·²å®‰è£…"
        3. ç‰ˆæœ¬å·æ˜¾ç¤ºå†…æ ¸ç‰ˆæœ¬

        ã€å¸¸è§é—®é¢˜ã€‘
        Q: åˆ·å…¥åMagiskæ¶ˆå¤±äº†ï¼Ÿ
        A: æ­£å¸¸ï¼ŒKernelSUæ›¿ä»£äº†Magisk

        Q: åŸæ¥çš„Magiskæ¨¡å—è¿˜èƒ½ç”¨å—ï¼Ÿ
        A: éœ€è¦è½¬æ¢ä¸ºKernelSUæ¨¡å—æ ¼å¼

        Q: å¦‚ä½•å¸è½½KernelSUï¼Ÿ
        A: åˆ·å›åŸç‰ˆboot.imgå³å¯

        ========================================
        ç¼–è¯‘æ—¶é—´: $(date '+%Y-%m-%d %H:%M:%S')
        ========================================
        DOC_END

    - name: ä¸Šä¼ ç¼–è¯‘ç»“æœ
      uses: actions/upload-artifact@v4
      with:
        name: KernelSU-Camellia-${{ github.run_number }}
        path: |
          /home/runner/output/

    - name: ç”Ÿæˆæ‘˜è¦æŠ¥å‘Š
      run: |
        echo "# âœ… KernelSUå†…æ ¸ç¼–è¯‘æˆåŠŸ!" >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY
        echo "## ğŸ“± è®¾å¤‡ä¿¡æ¯" >> $GITHUB_STEP_SUMMARY
        echo "- **å‹å·**: çº¢ç±³Note 10 (camellia)" >> $GITHUB_STEP_SUMMARY
        echo "- **å¤„ç†å™¨**: MediaTek Dimensity 700" >> $GITHUB_STEP_SUMMARY
        echo "- **Android**: 11 (R)" >> $GITHUB_STEP_SUMMARY
        echo "- **åˆ†åŒºç±»å‹**: VAB (Virtual A/B)" >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY
        echo "## ğŸ“¦ ç¼–è¯‘ä¿¡æ¯" >> $GITHUB_STEP_SUMMARY
        echo "- **å†…æ ¸å¤§å°**: $(ls -lh $HOME/output/Image.gz-dtb | awk '{print $5}')" >> $GITHUB_STEP_SUMMARY
        echo "- **ç¼–è¯‘æ—¶é—´**: $(date '+%Y-%m-%d %H:%M:%S')" >> $GITHUB_STEP_SUMMARY
        echo "- **æ„å»ºç¼–å·**: #${{ github.run_number }}" >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY
        echo "## ğŸš€ ä½¿ç”¨æ–¹æ³•" >> $GITHUB_STEP_SUMMARY
        echo "1. ä¸‹è½½ **KernelSU-Camellia-${{ github.run_number }}.zip**" >> $GITHUB_STEP_SUMMARY
        echo "2. è§£å‹å¹¶æŸ¥çœ‹ **README_CN.txt**" >> $GITHUB_STEP_SUMMARY
        echo "3. ä½¿ç”¨æä¾›çš„è„šæœ¬åˆ¶ä½œboot.img" >> $GITHUB_STEP_SUMMARY
        echo "4. åˆ·å…¥å¹¶å®‰è£…KernelSUç®¡ç†å™¨" >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY
        echo "## âš ï¸ é‡è¦æé†’" >> $GITHUB_STEP_SUMMARY
        echo "- **è¿™æ˜¯KernelSUå†…æ ¸ï¼Œä¼šæ›¿ä»£Magisk/Kitsune Mask**" >> $GITHUB_STEP_SUMMARY
        echo "- **åˆ·å…¥å‰åŠ¡å¿…å¤‡ä»½åŸç‰ˆboot.img**" >> $GITHUB_STEP_SUMMARY
        echo "- **éœ€è¦è§£é”Bootloader**" >> $GITHUB_STEP_SUMMARY
        echo "- **ä¸‹è½½KernelSUç®¡ç†å™¨**: [GitHub Releases](https://github.com/tiann/KernelSU/releases)" >> $GITHUB_STEP_SUMMARY
